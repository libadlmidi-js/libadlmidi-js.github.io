{
  "version": 3,
  "sources": ["../src/libadlmidi.js"],
  "sourcesContent": ["/**\n * libADLMIDI-JS - Main Thread Interface\n * \n * High-level API for real-time OPL3 FM synthesis in the browser.\n * \n * @example\n * ```javascript\n * import { AdlMidi } from 'libadlmidi-js';\n * \n * const synth = new AdlMidi();\n * await synth.init('/path/to/processor.js');\n * \n * synth.noteOn(0, 60, 100);  // Middle C on channel 0\n * synth.noteOff(0, 60);\n * ```\n */\n\n/**\n * Bank identifier for instrument access\n * @typedef {Object} BankId\n * @property {boolean} percussive - True for percussion bank, false for melodic\n * @property {number} msb - Bank MSB (0-127)\n * @property {number} lsb - Bank LSB (0-127)\n */\n\n/**\n * OPL3 operator parameters  \n * @typedef {Object} Operator\n * @property {boolean} am - Amplitude modulation (tremolo)\n * @property {boolean} vibrato - Vibrato (frequency modulation)\n * @property {boolean} sustaining - Sustaining (EG type)\n * @property {boolean} ksr - Key scale rate\n * @property {number} freqMult - Frequency multiplier (0-15)\n * @property {number} keyScaleLevel - Key scale level (0-3)\n * @property {number} totalLevel - Total level / attenuation (0-63, 0 = loudest)\n * @property {number} attack - Attack rate (0-15)\n * @property {number} decay - Decay rate (0-15)\n * @property {number} sustain - Sustain level (0-15, 0 = loudest)\n * @property {number} release - Release rate (0-15)\n * @property {number} waveform - Waveform select (0-7)\n */\n\n/**\n * Complete OPL3 instrument definition\n * @typedef {Object} Instrument\n * @property {boolean} is4op - 4-operator mode enabled\n * @property {boolean} isPseudo4op - Pseudo 4-op (two 2-op voices)\n * @property {boolean} isBlank - Blank/unused instrument\n * @property {boolean} isRhythmModeCar - Rhythm mode carrier flag\n * @property {boolean} isRhythmModeMod - Rhythm mode modulator flag\n * @property {number} feedback1 - Voice 1 feedback (0-7)\n * @property {number} connection1 - Voice 1 connection (0 = FM, 1 = additive)\n * @property {number} feedback2 - Voice 2 feedback (0-7, 4-op only)\n * @property {number} connection2 - Voice 2 connection (0 = FM, 1 = additive, 4-op only)\n * @property {number} noteOffset1 - Note offset for voice 1 (semitones)\n * @property {number} noteOffset2 - Note offset for voice 2 (semitones)\n * @property {number} velocityOffset - Velocity offset\n * @property {number} secondVoiceDetune - Second voice detune (cents)\n * @property {number} percussionNote - Percussion note number\n * @property {number} delayOnMs - Delay before note-on (ms)\n * @property {number} delayOffMs - Delay before note-off (ms)\n * @property {[Operator, Operator, Operator, Operator]} operators - Four operators\n */\n\n/**\n * Configuration settings for the synthesizer\n * @typedef {Object} ConfigureSettings\n * @property {number} [numChips] - Number of emulated OPL3 chips (1-100)\n * @property {number} [numFourOpChannels] - Number of 4-op channels (-1 = auto)\n * @property {number} [bank] - Embedded bank number\n * @property {boolean} [softPan] - Enable soft stereo panning\n * @property {boolean} [deepVibrato] - Enable deep vibrato\n * @property {boolean} [deepTremolo] - Enable deep tremolo\n */\n\n/**\n * Available OPL3 emulator cores.\n * Use with switchEmulator() to change the synthesis engine at runtime.\n * Note: Only emulators compiled into the current profile are available.\n * @readonly\n * @enum {number}\n */\nexport const Emulator = Object.freeze({\n    /** Nuked OPL3 v1.8 - Most accurate, higher CPU usage */\n    NUKED: 0,\n    /** Nuked OPL3 v1.7.4 - Slightly older version */\n    NUKED_174: 1,\n    /** DosBox OPL3 - Good accuracy, lower CPU usage */\n    DOSBOX: 2,\n    /** Opal - Reality Adlib Tracker emulator */\n    OPAL: 3,\n    /** Java OPL3 - Port of emu8950 */\n    JAVA: 4,\n    /** ESFMu - ESFM chip emulator */\n    ESFMU: 5,\n    /** MAME OPL2 */\n    MAME_OPL2: 6,\n    /** YMFM OPL2 */\n    YMFM_OPL2: 7,\n    /** YMFM OPL3 */\n    YMFM_OPL3: 8,\n    /** Nuked OPL2 LLE - Transistor-level emulation */\n    NUKED_OPL2_LLE: 9,\n    /** Nuked OPL3 LLE - Transistor-level emulation */\n    NUKED_OPL3_LLE: 10,\n});\n\nexport class AdlMidi {\n    /** @type {boolean} */\n    #ready = false;\n    /** @type {Map<string, Set<Function>>} */\n    #messageHandlers = new Map();\n\n    /**\n     * Create a new AdlMidi instance\n     * @param {AudioContext} [context] - Optional AudioContext to use. Creates one if not provided.\n     */\n    constructor(context) {\n        this.ctx = context || null;\n        this.node = null;\n    }\n\n    /**\n     * Get the AudioContext (may be null before init)\n     * @returns {AudioContext | null}\n     */\n    get audioContext() {\n        return this.ctx;\n    }\n\n    /**\n     * Check if the synth is ready\n     * @returns {boolean}\n     */\n    get ready() {\n        return this.#ready;\n    }\n\n    /**\n     * Initialize the synthesizer\n     * @param {string} processorUrl - URL to the bundled processor JavaScript file\n     * @param {string | null} [wasmUrl=null] - Optional URL to the .wasm file for split builds.\n     *                             If not provided, assumes bundled version with embedded WASM.\n     * @returns {Promise<void>}\n     */\n    async init(processorUrl, wasmUrl = null) {\n        if (!this.ctx) {\n            this.ctx = new AudioContext({ sampleRate: 44100 });\n        }\n\n        // Resume AudioContext if suspended (browser autoplay policy)\n        if (this.ctx.state === 'suspended') {\n            await this.ctx.resume();\n        }\n\n        // For split builds, fetch the WASM binary from main thread\n        // (AudioWorklet doesn't have fetch access)\n        // If wasmUrl not provided, derive it from processorUrl\n        let wasmBinary = null;\n        const effectiveWasmUrl = wasmUrl || processorUrl.replace('.processor.js', '.core.wasm');\n        const response = await fetch(effectiveWasmUrl);\n        if (!response.ok) {\n            throw new Error(`Failed to fetch WASM: ${response.status}`);\n        }\n        wasmBinary = await response.arrayBuffer();\n\n        // Add the AudioWorklet module\n        await this.ctx.audioWorklet.addModule(processorUrl);\n\n        // Create the AudioWorkletNode\n        this.node = new AudioWorkletNode(this.ctx, 'adl-midi-processor', {\n            processorOptions: {\n                sampleRate: this.ctx.sampleRate,\n                wasmBinary: wasmBinary  // null for bundled, ArrayBuffer for split\n            }\n        });\n\n        // Connect to destination\n        this.node.connect(this.ctx.destination);\n\n        // Set up message handling\n        this.node.port.onmessage = (e) => this.#handleMessage(e.data);\n\n        // Wait for the processor to be ready\n        return new Promise((resolve, reject) => {\n            const timeout = setTimeout(() => {\n                reject(new Error('Timeout waiting for WASM initialization'));\n            }, 10000);\n\n            this.#onceMessage('ready', () => {\n                clearTimeout(timeout);\n                this.#ready = true;\n                resolve();\n            });\n\n            this.#onceMessage('error', /** @param {{message: string}} msg */(msg) => {\n                clearTimeout(timeout);\n                reject(new Error(msg.message));\n            });\n        });\n    }\n\n    /**\n     * Internal message handler\n     * @param {{type: string}} msg - Message from processor\n     */\n    #handleMessage(msg) {\n        const handlers = this.#messageHandlers.get(msg.type);\n        if (handlers) {\n            handlers.forEach(/** @param {Function} handler */ handler => handler(msg));\n        }\n    }\n\n    /**\n     * Register a one-time message handler\n     * @param {string} type - Message type\n     * @param {Function} handler - Handler function\n     */\n    #onceMessage(type, handler) {\n        if (!this.#messageHandlers.has(type)) {\n            this.#messageHandlers.set(type, new Set());\n        }\n\n        /** @param {Object} msg */\n        const wrappedHandler = (msg) => {\n            this.#messageHandlers.get(type)?.delete(wrappedHandler);\n            handler(msg);\n        };\n\n        this.#messageHandlers.get(type)?.add(wrappedHandler);\n    }\n\n    /**\n     * Send a message to the processor\n     * @param {Object} msg - Message to send\n     */\n    #send(msg) {\n        if (this.node) {\n            this.node.port.postMessage(msg);\n        }\n    }\n\n    /**\n     * Play a note\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} note - MIDI note number (0-127)\n     * @param {number} velocity - Note velocity (0-127)\n     */\n    noteOn(channel, note, velocity) {\n        this.#send({ type: 'noteOn', channel, note, velocity });\n    }\n\n    /**\n     * Stop a note\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} note - MIDI note number (0-127)\n     */\n    noteOff(channel, note) {\n        this.#send({ type: 'noteOff', channel, note });\n    }\n\n    /**\n     * Set pitch bend\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} value - Pitch bend value (0-16383, 8192 = center)\n     */\n    pitchBend(channel, value) {\n        const lsb = value & 0x7F;\n        const msb = (value >> 7) & 0x7F;\n        this.#send({ type: 'pitchBend', channel, lsb, msb });\n    }\n\n    /**\n     * Send a control change\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} controller - Controller number (0-127)\n     * @param {number} value - Controller value (0-127)\n     */\n    controlChange(channel, controller, value) {\n        this.#send({ type: 'controlChange', channel, controller, value });\n    }\n\n    /**\n     * Change program (instrument)\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} program - Program number (0-127)\n     */\n    programChange(channel, program) {\n        this.#send({ type: 'programChange', channel, program });\n    }\n\n    /**\n     * Send note aftertouch\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} note - Note number (0-127)\n     * @param {number} pressure - Pressure (0-127)\n     */\n    noteAfterTouch(channel, note, pressure) {\n        this.#send({ type: 'noteAfterTouch', channel, note, pressure });\n    }\n\n    /**\n     * Send channel aftertouch\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} pressure - Pressure (0-127)\n     */\n    channelAfterTouch(channel, pressure) {\n        this.#send({ type: 'channelAfterTouch', channel, pressure });\n    }\n\n    /**\n     * Change bank (16-bit)\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} bank - Bank number\n     */\n    bankChange(channel, bank) {\n        this.#send({ type: 'bankChange', channel, bank });\n    }\n\n    /**\n     * Change bank MSB\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} msb - Bank MSB (0-127)\n     */\n    bankChangeMSB(channel, msb) {\n        this.#send({ type: 'bankChangeMSB', channel, msb });\n    }\n\n    /**\n     * Change bank LSB\n     * @param {number} channel - MIDI channel (0-15)\n     * @param {number} lsb - Bank LSB (0-127)\n     */\n    bankChangeLSB(channel, lsb) {\n        this.#send({ type: 'bankChangeLSB', channel, lsb });\n    }\n\n    /**\n     * Reset the real-time state (stops all notes, resets controllers)\n     * @returns {void}\n     */\n    resetState() {\n        this.#send({ type: 'resetState' });\n    }\n\n    /**\n     * Panic - stop all sounds immediately\n     * @returns {void}\n     */\n    panic() {\n        this.#send({ type: 'panic' });\n    }\n\n    /**\n     * Configure synth settings at runtime\n     * @param {ConfigureSettings} settings - Settings object\n     * @returns {Promise<void>}\n     */\n    async configure(settings) {\n        return new Promise((resolve) => {\n            this.#onceMessage('configured', () => resolve());\n            this.#send({ type: 'configure', settings });\n        });\n    }\n\n    /**\n     * Load a custom bank file (WOPL format)\n     * @param {ArrayBuffer} arrayBuffer - Bank file data\n     * @returns {Promise<void>}\n     */\n    async loadBank(arrayBuffer) {\n        return new Promise((resolve, reject) => {\n            this.#onceMessage('bankLoaded', /** @param {{success: boolean, error?: string}} msg */(msg) => {\n                if (msg.success) {\n                    resolve();\n                } else {\n                    reject(new Error(msg.error || 'Failed to load bank'));\n                }\n            });\n\n            this.#send({ type: 'loadBank', data: arrayBuffer });\n        });\n    }\n\n    /**\n     * Set the embedded bank by number\n     * @param {number} bank - Bank number\n     * @returns {Promise<void>}\n     */\n    async setBank(bank) {\n        return new Promise((resolve, reject) => {\n            this.#onceMessage('bankSet', /** @param {{success: boolean}} msg */(msg) => {\n                if (msg.success) {\n                    resolve();\n                } else {\n                    reject(new Error(`Failed to set bank ${bank}`));\n                }\n            });\n\n            this.#send({ type: 'setBank', bank });\n        });\n    }\n\n    /**\n     * Get an instrument from a bank for editing\n     * @param {BankId} [bankId] - Bank identifier\n     * @param {number} [programNumber] - Program/instrument number (0-127)\n     * @returns {Promise<Instrument>} Instrument object with named properties\n     */\n    async getInstrument(bankId = { percussive: false, msb: 0, lsb: 0 }, programNumber = 0) {\n        return new Promise((resolve, reject) => {\n            this.#onceMessage('instrumentLoaded', /** @param {{success: boolean, instrument: Instrument, error?: string}} msg */(msg) => {\n                if (msg.success) {\n                    resolve(msg.instrument);\n                } else {\n                    reject(new Error(msg.error || 'Failed to get instrument'));\n                }\n            });\n\n            this.#send({ type: 'getInstrument', bankId, programNumber });\n        });\n    }\n\n    /**\n     * Set an instrument in a bank\n     * @param {BankId} bankId - Bank identifier\n     * @param {number} programNumber - Program/instrument number (0-127)\n     * @param {Instrument} instrument - Instrument object with operator parameters\n     * @returns {Promise<void>}\n     */\n    async setInstrument(bankId = { percussive: false, msb: 0, lsb: 0 }, programNumber, instrument) {\n        return new Promise((resolve, reject) => {\n            this.#onceMessage('instrumentSet', /** @param {{success: boolean, error?: string}} msg */(msg) => {\n                if (msg.success) {\n                    resolve();\n                } else {\n                    reject(new Error(msg.error || 'Failed to set instrument'));\n                }\n            });\n\n            this.#send({ type: 'setInstrument', bankId, programNumber, instrument });\n        });\n    }\n\n    /**\n     * Set the number of emulated OPL3 chips\n     * @param {number} chips - Number of chips (1-100)\n     */\n    setNumChips(chips) {\n        this.#send({ type: 'setNumChips', chips });\n    }\n\n    /**\n     * Set the number of 4-operator channels\n     * @param {number} channels - Number of channels (-1 for auto)\n     */\n    setNumFourOpChannels(channels) {\n        this.#send({ type: 'setNumFourOpChannels', channels });\n    }\n\n    /**\n     * Get the number of 4-operator channels\n     * @returns {Promise<number>}\n     */\n    async getNumFourOpChannels() {\n        return new Promise((resolve) => {\n            this.#onceMessage('numFourOpChannels', /** @param {{channels: number}} msg */(msg) => {\n                resolve(msg.channels);\n            });\n            this.#send({ type: 'getNumFourOpChannels' });\n        });\n    }\n\n    /**\n     * Enable/disable scaling of modulators by volume\n     * @param {boolean} enabled\n     */\n    setScaleModulators(enabled) {\n        this.#send({ type: 'setScaleModulators', enabled });\n    }\n\n    /**\n     * Enable/disable full-range brightness\n     * @param {boolean} enabled\n     */\n    setFullRangeBrightness(enabled) {\n        this.#send({ type: 'setFullRangeBrightness', enabled });\n    }\n\n    /**\n     * Enable/disable automatic arpeggio\n     * @param {boolean} enabled\n     */\n    setAutoArpeggio(enabled) {\n        this.#send({ type: 'setAutoArpeggio', enabled });\n    }\n\n    /**\n     * Get automatic arpeggio state\n     * @returns {Promise<boolean>}\n     */\n    async getAutoArpeggio() {\n        return new Promise((resolve) => {\n            this.#onceMessage('autoArpeggio', /** @param {{enabled: boolean}} msg */(msg) => {\n                resolve(msg.enabled);\n            });\n            this.#send({ type: 'getAutoArpeggio' });\n        });\n    }\n\n    /**\n     * Set channel allocation mode\n     * @param {number} mode - Mode ID\n     */\n    setChannelAllocMode(mode) {\n        this.#send({ type: 'setChannelAllocMode', mode });\n    }\n\n    /**\n     * Get channel allocation mode\n     * @returns {Promise<number>}\n     */\n    async getChannelAllocMode() {\n        return new Promise((resolve) => {\n            this.#onceMessage('channelAllocMode', /** @param {{mode: number}} msg */(msg) => {\n                resolve(msg.mode);\n            });\n            this.#send({ type: 'getChannelAllocMode' });\n        });\n    }\n\n    /**\n     * Set the volume model\n     * @param {number} model - Volume model number\n     */\n    setVolumeModel(model) {\n        this.#send({ type: 'setVolumeModel', model });\n    }\n\n    /**\n     * Enable/disable rhythm mode (percussion)\n     * @param {boolean} enabled\n     */\n    setPercussionMode(enabled) {\n        this.#send({ type: 'setPercMode', enabled });\n    }\n\n    /**\n     * Enable/disable deep vibrato\n     * @param {boolean} enabled\n     */\n    setVibrato(enabled) {\n        this.#send({ type: 'setVibrato', enabled });\n    }\n\n    /**\n     * Enable/disable deep tremolo\n     * @param {boolean} enabled\n     */\n    setTremolo(enabled) {\n        this.#send({ type: 'setTremolo', enabled });\n    }\n\n    /**\n     * Run emulator with PCM rate to reduce CPU usage\n     * @param {boolean} enabled\n     */\n    setRunAtPcmRate(enabled) {\n        this.#send({ type: 'setRunAtPcmRate', enabled });\n    }\n\n    /**\n     * Switch the OPL3 emulator core at runtime\n     * \n     * Only emulators compiled into the current build profile are available:\n     * - nuked profile: NUKED only\n     * - dosbox profile: DOSBOX only  \n     * - light profile: NUKED, DOSBOX\n     * - full profile: NUKED, DOSBOX, OPAL, JAVA, ESFMU, YMFM_OPL2, YMFM_OPL3\n     * \n     * @param {number} emulator - Emulator ID from the Emulator enum\n     * @returns {Promise<void>} Resolves when emulator is switched, rejects if unavailable\n     * @example\n     * import { AdlMidi, Emulator } from 'libadlmidi-js';\n     * await synth.switchEmulator(Emulator.DOSBOX);\n     */\n    async switchEmulator(emulator) {\n        return new Promise((resolve, reject) => {\n            this.#onceMessage('emulatorSwitched', /** @param {{success: boolean, emulator: number}} msg */(msg) => {\n                if (msg.success) {\n                    resolve();\n                } else {\n                    reject(new Error(`Failed to switch to emulator ${emulator}. It may not be available in this build profile.`));\n                }\n            });\n            this.#send({ type: 'switchEmulator', emulator });\n        });\n    }\n\n    /**\n     * Get the name of the currently active OPL3 emulator\n     * @returns {Promise<string>} Human-readable emulator name (e.g., \"Nuked OPL3 (v 1.8)\")\n     * @example\n     * const name = await synth.getEmulatorName();\n     * console.log(`Using: ${name}`);\n     */\n    async getEmulatorName() {\n        return new Promise((resolve) => {\n            this.#onceMessage('emulatorName', /** @param {{name: string}} msg */(msg) => {\n                resolve(msg.name);\n            });\n            this.#send({ type: 'getEmulatorName' });\n        });\n    }\n\n    /**\n     * Get the number of emulated chips\n     * @returns {Promise<number>}\n     */\n    async getNumChips() {\n        return new Promise((resolve) => {\n            this.#onceMessage('numChips', /** @param {{chips: number}} msg */(msg) => {\n                resolve(msg.chips);\n            });\n            this.#send({ type: 'getNumChips' });\n        });\n    }\n\n    /**\n     * Get the number of emulated chips obtained\n     * @returns {Promise<number>}\n     */\n    async getNumChipsObtained() {\n        return new Promise((resolve) => {\n            this.#onceMessage('numChipsObtained', /** @param {{chips: number}} msg */(msg) => {\n                resolve(msg.chips);\n            });\n            this.#send({ type: 'getNumChipsObtained' });\n        });\n    }\n\n    /**\n     * Get the volume range model\n     * @returns {Promise<number>}\n     */\n    async getVolumeModel() {\n        return new Promise((resolve) => {\n            this.#onceMessage('volumeModel', /** @param {{model: number}} msg */(msg) => {\n                resolve(msg.model);\n            });\n            this.#send({ type: 'getVolumeModel' });\n        });\n    }\n\n    /**\n     * Get list of embedded banks available in this build\n     * Note: Slim builds have no embedded banks and will return an empty array\n     * @returns {Promise<{id: number, name: string}[]>} Array of bank info objects\n     * @example\n     * const banks = await synth.getEmbeddedBanks();\n     * banks.forEach(b => console.log(`${b.id}: ${b.name}`));\n     */\n    async getEmbeddedBanks() {\n        return new Promise((resolve) => {\n            this.#onceMessage('embeddedBanks', /** @param {{banks: {id: number, name: string}[]}} msg */(msg) => {\n                resolve(msg.banks);\n            });\n            this.#send({ type: 'getEmbeddedBanks' });\n        });\n    }\n\n    /**\n     * Reset the synthesizer\n     * @returns {void}\n     */\n    reset() {\n        this.#send({ type: 'reset' });\n    }\n\n    // ================== MIDI File Playback API ==================\n\n    /**\n     * Load a MIDI file for playback\n     * @param {ArrayBuffer} arrayBuffer - MIDI file data\n     * @returns {Promise<{duration: number}>} Resolves with file info when loaded\n     */\n    async loadMidi(arrayBuffer) {\n        return new Promise((resolve, reject) => {\n            this.#onceMessage('midiLoaded', /** @param {{success: boolean, duration: number, error?: string}} msg */(msg) => {\n                if (msg.success) {\n                    resolve({ duration: msg.duration });\n                } else {\n                    reject(new Error(msg.error || 'Failed to load MIDI data'));\n                }\n            });\n\n            this.#send({ type: 'loadMidi', data: arrayBuffer });\n        });\n    }\n\n    /**\n     * Start or resume MIDI file playback\n     * @returns {void}\n     */\n    play() {\n        this.#send({ type: 'play' });\n    }\n\n    /**\n     * Stop MIDI file playback and rewind to beginning\n     * @returns {void}\n     */\n    stop() {\n        this.#send({ type: 'stop' });\n    }\n\n    /**\n     * Seek to a position in the MIDI file\n     * @param {number} seconds - Position in seconds\n     * @returns {void}\n     */\n    seek(seconds) {\n        this.#send({ type: 'seek', position: seconds });\n    }\n\n    /**\n     * Enable or disable looping for MIDI file playback\n     * @param {boolean} enabled - Whether to loop\n     * @returns {void}\n     */\n    setLoop(enabled) {\n        this.#send({ type: 'setLoop', enabled });\n    }\n\n    /**\n     * Set the playback tempo multiplier\n     * @param {number} tempo - Tempo multiplier (1.0 = normal speed)\n     * @returns {void}\n     */\n    setTempo(tempo) {\n        this.#send({ type: 'setTempo', tempo });\n    }\n\n    /**\n     * Get the current playback state\n     * @returns {Promise<{position: number, duration: number, atEnd: boolean, playMode: string}>}\n     */\n    async getPlaybackState() {\n        return new Promise((resolve) => {\n            this.#onceMessage('state', /** @param {{position: number, duration: number, atEnd: boolean, playMode: string}} msg */(msg) => {\n                resolve({\n                    position: msg.position,\n                    duration: msg.duration,\n                    atEnd: msg.atEnd,\n                    playMode: msg.playMode\n                });\n            });\n\n            this.#send({ type: 'getState' });\n        });\n    }\n\n    /**\n     * Register a handler for playback state updates\n     * Useful for progress tracking during playback\n     * @param {function({position: number, duration: number, atEnd: boolean, playMode: string}): void} handler\n     * @returns {function(): void} Unsubscribe function\n     */\n    onPlaybackState(handler) {\n        if (!this.#messageHandlers.has('state')) {\n            this.#messageHandlers.set('state', new Set());\n        }\n        this.#messageHandlers.get('state')?.add(handler);\n\n        // Return unsubscribe function\n        return () => {\n            this.#messageHandlers.get('state')?.delete(handler);\n        };\n    }\n\n    /**\n     * Register a handler for when playback ends naturally\n     * @param {function(): void} handler\n     * @returns {function(): void} Unsubscribe function\n     */\n    onPlaybackEnded(handler) {\n        if (!this.#messageHandlers.has('playbackEnded')) {\n            this.#messageHandlers.set('playbackEnded', new Set());\n        }\n        this.#messageHandlers.get('playbackEnded')?.add(handler);\n\n        // Return unsubscribe function\n        return () => {\n            this.#messageHandlers.get('playbackEnded')?.delete(handler);\n        };\n    }\n\n    /**\n     * Close the synthesizer and release resources\n     * @returns {void}\n     */\n    close() {\n        if (this.node) {\n            this.node.disconnect();\n            this.node = null;\n        }\n        this.#ready = false;\n    }\n\n    /**\n     * Suspend the AudioContext (save CPU when not in use)\n     * @returns {Promise<void>}\n     */\n    async suspend() {\n        if (this.ctx) {\n            await this.ctx.suspend();\n        }\n    }\n\n    /**\n     * Resume the AudioContext\n     * @returns {Promise<void>}\n     */\n    async resume() {\n        if (this.ctx) {\n            await this.ctx.resume();\n        }\n    }\n}\n\nexport default AdlMidi;\n"],
  "mappings": ";;;;;;;;;;AAkFO,IAAM,WAAW,OAAO,OAAO;AAAA;AAAA,EAElC,OAAO;AAAA;AAAA,EAEP,WAAW;AAAA;AAAA,EAEX,QAAQ;AAAA;AAAA,EAER,MAAM;AAAA;AAAA,EAEN,MAAM;AAAA;AAAA,EAEN,OAAO;AAAA;AAAA,EAEP,WAAW;AAAA;AAAA,EAEX,WAAW;AAAA;AAAA,EAEX,WAAW;AAAA;AAAA,EAEX,gBAAgB;AAAA;AAAA,EAEhB,gBAAgB;AACpB,CAAC;AAzGD;AA2GO,IAAM,UAAN,MAAc;AAAA;AAAA;AAAA;AAAA;AAAA,EAUjB,YAAY,SAAS;AAVlB;AAEH;AAAA,+BAAS;AAET;AAAA,yCAAmB,oBAAI,IAAI;AAOvB,SAAK,MAAM,WAAW;AACtB,SAAK,OAAO;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,IAAI,eAAe;AACf,WAAO,KAAK;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,IAAI,QAAQ;AACR,WAAO,mBAAK;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,KAAK,cAAc,UAAU,MAAM;AACrC,QAAI,CAAC,KAAK,KAAK;AACX,WAAK,MAAM,IAAI,aAAa,EAAE,YAAY,MAAM,CAAC;AAAA,IACrD;AAGA,QAAI,KAAK,IAAI,UAAU,aAAa;AAChC,YAAM,KAAK,IAAI,OAAO;AAAA,IAC1B;AAKA,QAAI,aAAa;AACjB,UAAM,mBAAmB,WAAW,aAAa,QAAQ,iBAAiB,YAAY;AACtF,UAAM,WAAW,MAAM,MAAM,gBAAgB;AAC7C,QAAI,CAAC,SAAS,IAAI;AACd,YAAM,IAAI,MAAM,yBAAyB,SAAS,MAAM,EAAE;AAAA,IAC9D;AACA,iBAAa,MAAM,SAAS,YAAY;AAGxC,UAAM,KAAK,IAAI,aAAa,UAAU,YAAY;AAGlD,SAAK,OAAO,IAAI,iBAAiB,KAAK,KAAK,sBAAsB;AAAA,MAC7D,kBAAkB;AAAA,QACd,YAAY,KAAK,IAAI;AAAA,QACrB;AAAA;AAAA,MACJ;AAAA,IACJ,CAAC;AAGD,SAAK,KAAK,QAAQ,KAAK,IAAI,WAAW;AAGtC,SAAK,KAAK,KAAK,YAAY,CAAC,MAAM,sBAAK,sCAAL,WAAoB,EAAE;AAGxD,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,YAAM,UAAU,WAAW,MAAM;AAC7B,eAAO,IAAI,MAAM,yCAAyC,CAAC;AAAA,MAC/D,GAAG,GAAK;AAER,4BAAK,oCAAL,WAAkB,SAAS,MAAM;AAC7B,qBAAa,OAAO;AACpB,2BAAK,QAAS;AACd,gBAAQ;AAAA,MACZ;AAEA,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAA8C,CAAC,QAAQ;AACrE,uBAAa,OAAO;AACpB,iBAAO,IAAI,MAAM,IAAI,OAAO,CAAC;AAAA,QACjC;AAAA;AAAA,IACJ,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgDA,OAAO,SAAS,MAAM,UAAU;AAC5B,0BAAK,6BAAL,WAAW,EAAE,MAAM,UAAU,SAAS,MAAM,SAAS;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,QAAQ,SAAS,MAAM;AACnB,0BAAK,6BAAL,WAAW,EAAE,MAAM,WAAW,SAAS,KAAK;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,UAAU,SAAS,OAAO;AACtB,UAAM,MAAM,QAAQ;AACpB,UAAM,MAAO,SAAS,IAAK;AAC3B,0BAAK,6BAAL,WAAW,EAAE,MAAM,aAAa,SAAS,KAAK,IAAI;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,cAAc,SAAS,YAAY,OAAO;AACtC,0BAAK,6BAAL,WAAW,EAAE,MAAM,iBAAiB,SAAS,YAAY,MAAM;AAAA,EACnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,cAAc,SAAS,SAAS;AAC5B,0BAAK,6BAAL,WAAW,EAAE,MAAM,iBAAiB,SAAS,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,eAAe,SAAS,MAAM,UAAU;AACpC,0BAAK,6BAAL,WAAW,EAAE,MAAM,kBAAkB,SAAS,MAAM,SAAS;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,kBAAkB,SAAS,UAAU;AACjC,0BAAK,6BAAL,WAAW,EAAE,MAAM,qBAAqB,SAAS,SAAS;AAAA,EAC9D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,WAAW,SAAS,MAAM;AACtB,0BAAK,6BAAL,WAAW,EAAE,MAAM,cAAc,SAAS,KAAK;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,cAAc,SAAS,KAAK;AACxB,0BAAK,6BAAL,WAAW,EAAE,MAAM,iBAAiB,SAAS,IAAI;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,cAAc,SAAS,KAAK;AACxB,0BAAK,6BAAL,WAAW,EAAE,MAAM,iBAAiB,SAAS,IAAI;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,aAAa;AACT,0BAAK,6BAAL,WAAW,EAAE,MAAM,aAAa;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,QAAQ;AACJ,0BAAK,6BAAL,WAAW,EAAE,MAAM,QAAQ;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,UAAU,UAAU;AACtB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL,WAAkB,cAAc,MAAM,QAAQ;AAC9C,4BAAK,6BAAL,WAAW,EAAE,MAAM,aAAa,SAAS;AAAA,IAC7C,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,SAAS,aAAa;AACxB,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAoE,CAAC,QAAQ;AAC3F,cAAI,IAAI,SAAS;AACb,oBAAQ;AAAA,UACZ,OAAO;AACH,mBAAO,IAAI,MAAM,IAAI,SAAS,qBAAqB,CAAC;AAAA,UACxD;AAAA,QACJ;AAAA;AAEA,4BAAK,6BAAL,WAAW,EAAE,MAAM,YAAY,MAAM,YAAY;AAAA,IACrD,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,QAAQ,MAAM;AAChB,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAiD,CAAC,QAAQ;AACxE,cAAI,IAAI,SAAS;AACb,oBAAQ;AAAA,UACZ,OAAO;AACH,mBAAO,IAAI,MAAM,sBAAsB,IAAI,EAAE,CAAC;AAAA,UAClD;AAAA,QACJ;AAAA;AAEA,4BAAK,6BAAL,WAAW,EAAE,MAAM,WAAW,KAAK;AAAA,IACvC,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,MAAM,cAAc,SAAS,EAAE,YAAY,OAAO,KAAK,GAAG,KAAK,EAAE,GAAG,gBAAgB,GAAG;AACnF,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAkG,CAAC,QAAQ;AACzH,cAAI,IAAI,SAAS;AACb,oBAAQ,IAAI,UAAU;AAAA,UAC1B,OAAO;AACH,mBAAO,IAAI,MAAM,IAAI,SAAS,0BAA0B,CAAC;AAAA,UAC7D;AAAA,QACJ;AAAA;AAEA,4BAAK,6BAAL,WAAW,EAAE,MAAM,iBAAiB,QAAQ,cAAc;AAAA,IAC9D,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,cAAc,SAAS,EAAE,YAAY,OAAO,KAAK,GAAG,KAAK,EAAE,GAAG,eAAe,YAAY;AAC3F,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAuE,CAAC,QAAQ;AAC9F,cAAI,IAAI,SAAS;AACb,oBAAQ;AAAA,UACZ,OAAO;AACH,mBAAO,IAAI,MAAM,IAAI,SAAS,0BAA0B,CAAC;AAAA,UAC7D;AAAA,QACJ;AAAA;AAEA,4BAAK,6BAAL,WAAW,EAAE,MAAM,iBAAiB,QAAQ,eAAe,WAAW;AAAA,IAC1E,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,YAAY,OAAO;AACf,0BAAK,6BAAL,WAAW,EAAE,MAAM,eAAe,MAAM;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,qBAAqB,UAAU;AAC3B,0BAAK,6BAAL,WAAW,EAAE,MAAM,wBAAwB,SAAS;AAAA,EACxD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,uBAAuB;AACzB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAA2D,CAAC,QAAQ;AAClF,kBAAQ,IAAI,QAAQ;AAAA,QACxB;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,uBAAuB;AAAA,IAC9C,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,mBAAmB,SAAS;AACxB,0BAAK,6BAAL,WAAW,EAAE,MAAM,sBAAsB,QAAQ;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,uBAAuB,SAAS;AAC5B,0BAAK,6BAAL,WAAW,EAAE,MAAM,0BAA0B,QAAQ;AAAA,EACzD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,gBAAgB,SAAS;AACrB,0BAAK,6BAAL,WAAW,EAAE,MAAM,mBAAmB,QAAQ;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,kBAAkB;AACpB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAsD,CAAC,QAAQ;AAC7E,kBAAQ,IAAI,OAAO;AAAA,QACvB;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,kBAAkB;AAAA,IACzC,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,oBAAoB,MAAM;AACtB,0BAAK,6BAAL,WAAW,EAAE,MAAM,uBAAuB,KAAK;AAAA,EACnD;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,sBAAsB;AACxB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAsD,CAAC,QAAQ;AAC7E,kBAAQ,IAAI,IAAI;AAAA,QACpB;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,sBAAsB;AAAA,IAC7C,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,eAAe,OAAO;AAClB,0BAAK,6BAAL,WAAW,EAAE,MAAM,kBAAkB,MAAM;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,kBAAkB,SAAS;AACvB,0BAAK,6BAAL,WAAW,EAAE,MAAM,eAAe,QAAQ;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,WAAW,SAAS;AAChB,0BAAK,6BAAL,WAAW,EAAE,MAAM,cAAc,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,WAAW,SAAS;AAChB,0BAAK,6BAAL,WAAW,EAAE,MAAM,cAAc,QAAQ;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,gBAAgB,SAAS;AACrB,0BAAK,6BAAL,WAAW,EAAE,MAAM,mBAAmB,QAAQ;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBA,MAAM,eAAe,UAAU;AAC3B,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAA4E,CAAC,QAAQ;AACnG,cAAI,IAAI,SAAS;AACb,oBAAQ;AAAA,UACZ,OAAO;AACH,mBAAO,IAAI,MAAM,gCAAgC,QAAQ,kDAAkD,CAAC;AAAA,UAChH;AAAA,QACJ;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,kBAAkB,SAAS;AAAA,IAClD,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,kBAAkB;AACpB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAkD,CAAC,QAAQ;AACzE,kBAAQ,IAAI,IAAI;AAAA,QACpB;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,kBAAkB;AAAA,IACzC,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,cAAc;AAChB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAA+C,CAAC,QAAQ;AACtE,kBAAQ,IAAI,KAAK;AAAA,QACrB;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,cAAc;AAAA,IACrC,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,sBAAsB;AACxB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAuD,CAAC,QAAQ;AAC9E,kBAAQ,IAAI,KAAK;AAAA,QACrB;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,sBAAsB;AAAA,IAC7C,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,iBAAiB;AACnB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAkD,CAAC,QAAQ;AACzE,kBAAQ,IAAI,KAAK;AAAA,QACrB;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,iBAAiB;AAAA,IACxC,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAM,mBAAmB;AACrB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAA0E,CAAC,QAAQ;AACjG,kBAAQ,IAAI,KAAK;AAAA,QACrB;AAAA;AACA,4BAAK,6BAAL,WAAW,EAAE,MAAM,mBAAmB;AAAA,IAC1C,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,QAAQ;AACJ,0BAAK,6BAAL,WAAW,EAAE,MAAM,QAAQ;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,SAAS,aAAa;AACxB,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAsF,CAAC,QAAQ;AAC7G,cAAI,IAAI,SAAS;AACb,oBAAQ,EAAE,UAAU,IAAI,SAAS,CAAC;AAAA,UACtC,OAAO;AACH,mBAAO,IAAI,MAAM,IAAI,SAAS,0BAA0B,CAAC;AAAA,UAC7D;AAAA,QACJ;AAAA;AAEA,4BAAK,6BAAL,WAAW,EAAE,MAAM,YAAY,MAAM,YAAY;AAAA,IACrD,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,OAAO;AACH,0BAAK,6BAAL,WAAW,EAAE,MAAM,OAAO;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,OAAO;AACH,0BAAK,6BAAL,WAAW,EAAE,MAAM,OAAO;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,KAAK,SAAS;AACV,0BAAK,6BAAL,WAAW,EAAE,MAAM,QAAQ,UAAU,QAAQ;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,QAAQ,SAAS;AACb,0BAAK,6BAAL,WAAW,EAAE,MAAM,WAAW,QAAQ;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,SAAS,OAAO;AACZ,0BAAK,6BAAL,WAAW,EAAE,MAAM,YAAY,MAAM;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,mBAAmB;AACrB,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,4BAAK,oCAAL;AAAA;AAAA,QAAkB;AAAA;AAAA,QAAmG,CAAC,QAAQ;AAC1H,kBAAQ;AAAA,YACJ,UAAU,IAAI;AAAA,YACd,UAAU,IAAI;AAAA,YACd,OAAO,IAAI;AAAA,YACX,UAAU,IAAI;AAAA,UAClB,CAAC;AAAA,QACL;AAAA;AAEA,4BAAK,6BAAL,WAAW,EAAE,MAAM,WAAW;AAAA,IAClC,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,gBAAgB,SAAS;AACrB,QAAI,CAAC,mBAAK,kBAAiB,IAAI,OAAO,GAAG;AACrC,yBAAK,kBAAiB,IAAI,SAAS,oBAAI,IAAI,CAAC;AAAA,IAChD;AACA,uBAAK,kBAAiB,IAAI,OAAO,GAAG,IAAI,OAAO;AAG/C,WAAO,MAAM;AACT,yBAAK,kBAAiB,IAAI,OAAO,GAAG,OAAO,OAAO;AAAA,IACtD;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,gBAAgB,SAAS;AACrB,QAAI,CAAC,mBAAK,kBAAiB,IAAI,eAAe,GAAG;AAC7C,yBAAK,kBAAiB,IAAI,iBAAiB,oBAAI,IAAI,CAAC;AAAA,IACxD;AACA,uBAAK,kBAAiB,IAAI,eAAe,GAAG,IAAI,OAAO;AAGvD,WAAO,MAAM;AACT,yBAAK,kBAAiB,IAAI,eAAe,GAAG,OAAO,OAAO;AAAA,IAC9D;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,QAAQ;AACJ,QAAI,KAAK,MAAM;AACX,WAAK,KAAK,WAAW;AACrB,WAAK,OAAO;AAAA,IAChB;AACA,uBAAK,QAAS;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,UAAU;AACZ,QAAI,KAAK,KAAK;AACV,YAAM,KAAK,IAAI,QAAQ;AAAA,IAC3B;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,SAAS;AACX,QAAI,KAAK,KAAK;AACV,YAAM,KAAK,IAAI,OAAO;AAAA,IAC1B;AAAA,EACJ;AACJ;AA/sBI;AAEA;AAJG;AAAA;AAAA;AAAA;AAAA;AAmGH,mBAAc,SAAC,KAAK;AAChB,QAAM,WAAW,mBAAK,kBAAiB,IAAI,IAAI,IAAI;AACnD,MAAI,UAAU;AACV,aAAS;AAAA;AAAA,MAAyC,aAAW,QAAQ,GAAG;AAAA,IAAC;AAAA,EAC7E;AACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA,iBAAY,SAAC,MAAM,SAAS;AACxB,MAAI,CAAC,mBAAK,kBAAiB,IAAI,IAAI,GAAG;AAClC,uBAAK,kBAAiB,IAAI,MAAM,oBAAI,IAAI,CAAC;AAAA,EAC7C;AAGA,QAAM,iBAAiB,CAAC,QAAQ;AAC5B,uBAAK,kBAAiB,IAAI,IAAI,GAAG,OAAO,cAAc;AACtD,YAAQ,GAAG;AAAA,EACf;AAEA,qBAAK,kBAAiB,IAAI,IAAI,GAAG,IAAI,cAAc;AACvD;AAAA;AAAA;AAAA;AAAA;AAMA,UAAK,SAAC,KAAK;AACP,MAAI,KAAK,MAAM;AACX,SAAK,KAAK,KAAK,YAAY,GAAG;AAAA,EAClC;AACJ;AA8kBJ,IAAO,qBAAQ;",
  "names": []
}
